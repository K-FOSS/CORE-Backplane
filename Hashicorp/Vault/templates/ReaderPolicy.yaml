apiVersion: vault.vault.upbound.io/v1alpha1
kind: Policy
metadata:
  name: reader
spec:
  providerConfigRef:
    name: vault-provider

  forProvider:
    name: reader
    policy: |
      path "/secret/*" {
          capabilities = ["read", "list"]
      }

      # Write ACL policies
      path "sys/policies/acl/*" {
        capabilities = [ "create", "read", "update", "delete", "list" ]
      }

      # List available secrets engines to retrieve accessor ID
      path "sys/mounts" {
        capabilities = [ "read" ]
      }

      # Manage secrets engines
      path "sys/mounts/*" {
        capabilities = ["create", "read", "update", "delete", "list", "sudo"]
      }

      # List, create, update, and delete key/value secrets
      path "secret/*" {
        capabilities = ["create", "read", "update", "delete", "list", "sudo"]
      }