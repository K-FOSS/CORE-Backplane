apiVersion: policy.karmada.io/v1alpha1
kind: PropagationPolicy
metadata:
  name: vitess-sync

spec:
  propagateDeps: true
  resourceSelectors:
    - apiVersion: v1
      kind: Pod
      labelSelector:
        matchLabels:
          app: vitess-operator

    - apiVersion: v1
      kind: Pod
      labelSelector:
        matchLabels:
          planetscale.com/component: etcd

    - apiVersion: v1
      kind: PersistentVolumeClaim
      labelSelector:
        matchLabels:
          planetscale.com/component: etcd

    - apiVersion: v1
      kind: PersistentVolumeClaim
      labelSelector:
        matchLabels:
          planetscale.com/component: vttablet

    - apiVersion: v1
      kind: Pod
      labelSelector:
        matchLabels:
          planetscale.com/component: vttablet

    - apiVersion: scheduling.k8s.io/v1
      kind: PriorityClass
      name: vitess

    - apiVersion: v1
      kind: Pod
      labelSelector:
        matchLabels:
          planetscale.com/component: vtctld

    - apiVersion: v1
      kind: Pod
      labelSelector:
        matchLabels:
          planetscale.com/component: vtgate

    - apiVersion: v1
      kind: Service
      labelSelector:
        matchLabels:
          planetscale.com/component: vtgate

    - apiVersion: v1
      kind: Service
      labelSelector:
        matchLabels:
          planetscale.com/component: vttablet

    - apiVersion: v1
      kind: Service
      labelSelector:
        matchLabels:
          etcd.planetscale.com/lockserver: example-etcd-faf13de3

  placement:
    clusterAffinity:
      clusterNames:
        - k0s-dc1