apiVersion: "tinkerbell.org/v1alpha1"
kind: Template
metadata:
  name: helloworld
spec:
  data: | 
    version: "0.1"
    name: helloworld
    global_timeout: 1800
    tasks:
      - name: "flatcar-install"
        worker: "{{.machine1}}"
        volumes:
          - /dev:/dev
          - /statedir:/statedir
        actions:
          - name: "dump-ignition"
            image: flatcar-install
            command:
              - sh
              - -c
              - echo 'ewogICAiaWduaXRpb24iIDogewogICAgICAiY29uZmlnIiA6IHt9LAogICAgICAidGltZW91dHMiIDoge30sCiAgICAgICJ2ZXJzaW9uIiA6ICIyLjEuMCIKICAgfSwKICAgIm5ldHdvcmtkIiA6IHt9LAogICAicGFzc3dkIiA6IHsKICAgICAgInVzZXJzIiA6IFsKICAgICAgICAgewogICAgICAgICAgICAibmFtZSIgOiAiY29yZSIsCiAgICAgICAgICAgICJzc2hBdXRob3JpemVkS2V5cyIgOiBbCiAgICAgICAgICAgICAgICJzc2gtcnNhIEFBQUFCM056YUMxeWMyRUFBQUFEQVFBQkFBQUJnUURmQmdiZ2hDNkRTMWVROWlKWTRFdktpQXRzbHZFa293UFY0UmRxT1BYTXBsZ2dVNzBIdWljVE13ZUNTOUVzVTZkTCtEVnE2TUZVam95QW5CTG41VERmL245TUQzSFZNZGVsVjVPSDJmV2huOTNFam1WalRCUC9oRWdxaEYrTGl3Z3lNRjBSRXNYbXBVbU83YzZ5OVdRa3FBY3JnVEUvZG4zQVQ1RjdlZ0ZzcDY4L0FycGxITVQzek1VTGxPNU10cnJ6Wk8xTlE3SWJqYi9lNUNuKyswWDZDRWdBTjYyaEgyRzZTbHcxNnNiWlRUWDZ2T2RmREZQWDhyMll5Y2RWUTAraUliMnRjVmxjZGxCenJ4c3cvUmkvUHExZldGcFZCbEFncmpYTmhJOUlVWWtXMksvVjV2a1pPcExVUkFwNEhEREtvTHVUMHJYZFhPaXM4RVp5VUc5akwyMDJqbTFEZTVFaHNCZ3paaVpmL2xnUTBSRHJReTlWelJIMTZpYWFabzlEbGwzTzhiUzMwM0ZiRTZwSUdjWXJVdTZ0YnJDaWdqUGtiRC84RHpmc3VWeVNXbUxVUk9IaDQ4SHRBNHYzRXltZ24xOHBVRnVaTFBPWnlFTWZmSjd4WFVJSlo1TFRBaVozVGk1bGZ0Y3dFZGlzSmJBdnRSTm5kS09Pa2ZJU3Nzcz0ga3Jpc3RpYW5mam9uZXNAS0pEZXYtTGFwdG9wMSIKICAgICAgICAgICAgXQogICAgICAgICB9CiAgICAgIF0KICAgfSwKICAgInN0b3JhZ2UiIDoge30sCiAgICJzeXN0ZW1kIiA6IHt9Cn0=' | base64 -d > /statedir/ignition.json
          - name: "flatcar-install"
            image: flatcar-install
            command:
              - /usr/local/bin/flatcar-install
              - -v
              - -s
              - -i
              - /statedir/ignition.json
              - -C alpha
              - -b
              - http://10.1.1.83/misc/flatcar/amd64-usr
