apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
    name: kjmedia-policy-internal
    namespace: external-istiod

spec:
  selector:
    matchLabels:
      istio: ingressgateway

  action: ALLOW

  rules:
    - from:
        - source:
            namespaces: 
              - core-prod
              - lab-prod

        - source:
            ipBlocks:
              - 172.16.0.0/12
              - 10.0.0.0/8

      to:
        - operation:
            hosts:
              - sabnzbd.kjmedia.stream
              - radarr.kjmedia.stream
              - prowlarr.kjmedia.stream
              - sonarr.kjmedia.stream
