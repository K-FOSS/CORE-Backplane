{{- $fullName := include "netbox.fullname" . -}}
---
apiVersion: networking.istio.io/v1beta1
kind: ServiceEntry
metadata:
  name: {{ $fullName }}

spec:
  hosts:
    - core-{{ $fullName }}.{{ .Release.Namespace }}.svc.k0s.resolvemy.host

  location: MESH_INTERNAL

  ports:
    - number: 8080
      name: http
      targetPort: 8080
      protocol: HTTP

  resolution: STATIC
  workloadSelector:
    labels:
      {{- include "netbox.selectorLabels" . | nindent 6 }}
      app.kubernetes.io/component: netbox
