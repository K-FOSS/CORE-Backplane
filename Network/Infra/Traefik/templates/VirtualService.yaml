apiVersion: networking.istio.io/v1beta1
kind: VirtualService
metadata:
  name: traefik
spec:
  hosts:
    - accessmyporn.download
    - resolvemy.host
    - controlcenter.house
    - '*.controlcenter.house'
    - 'feeds.kjmedia.stream'
    - '*.mylogin.space'
    - '*.writemy.codes'
    - '*.ipaddr.network'
    - 'ytdl.kjmedia.stream'
    - 'sonarr.kjmedia.stream'
    - 'radarr.kjmedia.stream'
    - 'prowlarr.kjmedia.stream'
    - 'bitwarden.kristianjones.dev'
  gateways:
    - traefik-gateway
  http:
    - name: pomerium-authn
      match:
        - headers:
            host:
              exact: 'authenticate.int.mylogin.space'
      route:
        - destination:
            port:
              number: 80
            host: traefik-core-pomerium-authenticate.core-prod.svc.k0s.resolvemy.host
  tls:
    - match:
        - port: 443
          sniHosts:
            - accessmyporn.download
            - resolvemy.host
            - controlcenter.house
            - '*.controlcenter.house'
            - '*.mylogin.space'
            - '*.int.mylogin.space'
            - '*.writemy.codes'
            - '*.ipaddr.network'
            - 'bitwarden.kristianjones.dev'
            - ytdl.kjmedia.stream
            - feeds.kjmedia.stream
            - sonarr.kjmedia.stream
            - radarr.kjmedia.stream
            - prowlarr.kjmedia.stream
      route:
        - destination:
            host: traefik-core.core-prod.svc.k0s.resolvemy.host
            port:
              number: 443
          weight: 100

