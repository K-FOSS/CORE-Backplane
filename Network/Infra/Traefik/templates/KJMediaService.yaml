apiVersion: networking.istio.io/v1alpha3
kind: VirtualService
metadata:
  name: kjmedia-ingress-service
spec:
  hosts:
    - '*.kjmedia.stream'
  gateways:
    - kjmedia-gateway
  tls:
    - match:
        - port: 443
          sniHosts:
            - jellyfin.kjmedia.stream
      route:
        - destination:
            host: jellyfin-core.lab-prod.svc.cluster.local
            port:
              number: 8096
          weight: 100

    - match:
        - port: 443
          sniHosts:
            - ytdl.kjmedia.stream
      route:
        - destination:
            host: ytdl-core-youtubedl-material.lab-prod.svc.cluster.local
            port:
              number: 17442
          weight: 100

