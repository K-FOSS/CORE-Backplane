
apiVersion: flowcontrol.apiserver.k8s.io/v1beta2
kind: FlowSchema
metadata:
  name: calico
spec:
  distinguisherMethod:
    type: ByUser
  matchingPrecedence: 200
  priorityLevelConfiguration:
    name: calico-controller
  rules:
    - resourceRules:
        - apiGroups:
            - '*'
          clusterScope: true
          namespaces:
            - '*'
          resources:
            - '*'
          verbs:
            - '*'
      subjects:
        - kind: ServiceAccount
          serviceAccount:
            name: tigera-operator
            namespace: tigera-operator

        - kind: ServiceAccount
          serviceAccount:
            name: metallb-core-controller
            namespace: metallb-system

        - kind: ServiceAccount
          serviceAccount:
            name: k0s-cntrl-rancher
            namespace: cattle-system
